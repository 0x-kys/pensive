# pensive

a tiny database that stores structured data and unstructured embeddings, with semantic search and hybrid queries

### Core features

- (done) sqlite-backed storage engine for structured documents
- (done) embedding index with cosine similarity search & FAISS flat index
- (done) hybrid query execution (structured filters + semantic ranking)
- (planned) natural-language -> structured query translation using a local mini LLM
- (planned) fastAPI + websocket with svelte dashboard
- (planned) plugin system for local data ingestion

### Examples

1. matching filters + semantic relevance

Query:
```py
    results = db.query(
        "notes",
        filters=[
            {
                "field": "content",
                "op": "in",
                "value": [
                    "mental",
                    "health",
                ],
            }
        ],
        semantic_query="mindfulness",
        top_k=3,
    )
```

Result:
```
❯ uv run cli.py search

Semantic Search Results:

Result #1
  ID: a46e99f5-9a3a-4c81-9c87-523e6abaf92c
  Score: 0.4057
  Title: Paragraph 5
  Content (preview): Good mental health requires consistent habits such as regular exercise, proper sleep, social interactions, and mindfulne...

Result #2
  ID: f86e3b31-0a53-4c48-8207-77f4b89c7c72
  Score: -0.0001
  Title: Paragraph 2
  Content (preview): Cooking at home has seen a resurgence as people look for healthier alternatives to fast food. Simple meals like stir-fri...
```

2. weak semantic match with strong filters

Query:
```py
    results = db.query(
        "notes",
        filters=[
            {
                "field": "content",
                "op": "in",
                "value": [
                    "mental",
                    "health",
                ],
            }
        ],
        semantic_query="mindful",
        top_k=3,
    )
```

Result:
```
❯ uv run cli.py search

Semantic Search Results:

Result #1
  ID: a46e99f5-9a3a-4c81-9c87-523e6abaf92c
  Score: 0.2142
  Title: Paragraph 5
  Content (preview): Good mental health requires consistent habits such as regular exercise, proper sleep, social interactions, and mindfulne...

Result #2
  ID: f86e3b31-0a53-4c48-8207-77f4b89c7c72
  Score: -0.0178
  Title: Paragraph 2
  Content (preview): Cooking at home has seen a resurgence as people look for healthier alternatives to fast food. Simple meals like stir-fri...
```
